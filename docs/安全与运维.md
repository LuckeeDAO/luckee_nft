# Luckee NFT åˆçº¦å®‰å…¨ä¸è¿ç»´æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Luckee NFT åˆçº¦çš„å®‰å…¨æœºåˆ¶ã€æƒé™æ§åˆ¶ã€è¿ç»´æµç¨‹å’Œå®¡è®¡è¦æ±‚ï¼Œç¡®ä¿åˆçº¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„å®‰å…¨ç¨³å®šè¿è¡Œã€‚

## å®‰å…¨æ¶æ„

### 1. æƒé™æ§åˆ¶ä½“ç³»

#### 1.1 è§’è‰²å®šä¹‰

**åˆçº¦æ‰€æœ‰è€… (Owner)**:
- æƒé™: æœ€é«˜æƒé™ï¼Œå¯æ‰§è¡Œæ‰€æœ‰ç®¡ç†å‘˜æ“ä½œ
- æ“ä½œ: æ›´æ–°é…ç½®ã€è®¾ç½®é…æ–¹ã€æš‚åœåˆçº¦ã€ç´§æ€¥æå–
- å®‰å…¨è¦æ±‚: å¿…é¡»ä½¿ç”¨å¤šç­¾é’±åŒ…æˆ–æ—¶é—´é”åˆçº¦

**æˆæƒé“¸é€ è€… (Authorized Minters)**:
- æƒé™: é“¸é€  NFT çš„æƒé™
- æ“ä½œ: å•ä¸ªé“¸é€ ã€æ‰¹é‡é“¸é€ 
- å®‰å…¨è¦æ±‚: æœ€å°æƒé™åŸåˆ™ï¼Œå®šæœŸå®¡è®¡

**æ™®é€šç”¨æˆ· (Users)**:
- æƒé™: æ ‡å‡† CW721 æ“ä½œ
- æ“ä½œ: è½¬ç§»ã€æ‰¹å‡†ã€é”€æ¯è‡ªå·±çš„ NFT
- å®‰å…¨è¦æ±‚: æ— ç‰¹æ®Šè¦æ±‚

#### 1.2 æƒé™éªŒè¯æœºåˆ¶

```rust
// æ‰€æœ‰è€…æƒé™éªŒè¯
pub fn verify_owner_permission(deps: Deps, sender: &Addr) -> Result<(), ContractError> {
    let config = CONFIG.load(deps.storage)?;
    if config.owner != *sender {
        return Err(ContractError::Unauthorized {});
    }
    Ok(())
}

// é“¸é€ è€…æƒé™éªŒè¯
pub fn verify_minter_permission(deps: Deps, sender: &Addr, config: &Config) -> Result<(), ContractError> {
    if !is_authorized_minter(deps, sender, config)? {
        return Err(ContractError::MinterNotAuthorized {});
    }
    Ok(())
}
```

### 2. è®¿é—®æ§åˆ¶

#### 2.1 åˆçº¦æš‚åœæœºåˆ¶

**æš‚åœåŠŸèƒ½**:
- è§¦å‘æ¡ä»¶: æ‰€æœ‰è€…è°ƒç”¨ `pause`
- å½±å“èŒƒå›´: é™¤ `unpause` å’Œ `emergency_withdraw` å¤–çš„æ‰€æœ‰æ“ä½œ
- æ¢å¤æ¡ä»¶: æ‰€æœ‰è€…è°ƒç”¨ `unpause`

**å®ç°ç¤ºä¾‹**:
```rust
pub fn execute_pause(deps: DepsMut, info: MessageInfo) -> Result<Response, ContractError> {
    verify_owner_permission(deps.as_ref(), &info.sender)?;
    
    CONTRACT_PAUSED.save(deps.storage, &true)?;
    
    Ok(Response::new()
        .add_attribute("action", "pause")
        .add_attribute("paused_by", info.sender.to_string()))
}
```

#### 2.2 ç´§æ€¥æå–æœºåˆ¶

**EmergencyWithdraw æƒé™**:
- ä»…åˆçº¦æ‰€æœ‰è€…å¯è°ƒç”¨
- å»ºè®®å¼ºåˆ¶ä½¿ç”¨å¤šç­¾é’±åŒ…ä½œä¸ºæ‰€æœ‰è€…
- å»ºè®®è®¾ç½®æ—¶é—´é”å»¶è¿Ÿ

**å®‰å…¨å®ç°**:
```rust
pub fn execute_emergency_withdraw(
    deps: DepsMut,
    info: MessageInfo,
    amount: Vec<Coin>,
) -> Result<Response, ContractError> {
    verify_owner_permission(deps.as_ref(), &info.sender)?;
    
    // éªŒè¯æå–é‡‘é¢
    for coin in &amount {
        if coin.amount.is_zero() {
            return Err(ContractError::InvalidAmount {});
        }
    }
    
    // æ‰§è¡Œæå–
    let mut response = Response::new()
        .add_attribute("action", "emergency_withdraw")
        .add_attribute("amount", format!("{:?}", amount));
    
    for coin in amount {
        response = response.add_message(BankMsg::Send {
            to_address: info.sender.to_string(),
            amount: vec![coin],
        });
    }
    
    Ok(response)
}
```

### 3. é“¸é€ è€…ç®¡ç†

#### 3.1 æœ€å°æƒé™åŸåˆ™

**ALLOWED_MINTERS ç®¡ç†**:
- å®šæœŸå®¡æŸ¥æˆæƒåˆ—è¡¨
- ç§»é™¤ä¸å¿…è¦çš„æˆæƒ
- è®°å½•æ‰€æœ‰å˜æ›´æ“ä½œ

**å®ç°ç¤ºä¾‹**:
```rust
pub fn execute_set_minter(
    deps: DepsMut,
    info: MessageInfo,
    minter: String,
    allowed: bool,
) -> Result<Response, ContractError> {
    verify_owner_permission(deps.as_ref(), &info.sender)?;
    
    let minter_addr = deps.api.addr_validate(&minter)?;
    ALLOWED_MINTERS.save(deps.storage, minter_addr.clone(), &allowed)?;
    
    // è®°å½•æ“ä½œæ—¥å¿—
    let log_entry = MinterChangeLog {
        timestamp: env.block.time.seconds(),
        changed_by: info.sender.clone(),
        minter: minter_addr.clone(),
        allowed,
    };
    MINTER_CHANGE_LOG.save(deps.storage, (info.sender.clone(), env.block.time.seconds()), &log_entry)?;
    
    Ok(Response::new()
        .add_attribute("action", "set_minter")
        .add_attribute("minter", minter)
        .add_attribute("allowed", allowed.to_string())
        .add_attribute("changed_by", info.sender.to_string()))
}
```

#### 3.2 æ“ä½œå®¡è®¡

**å®¡è®¡æ—¥å¿—ç»“æ„**:
```rust
#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub struct MinterChangeLog {
    pub timestamp: u64,
    pub changed_by: Addr,
    pub minter: Addr,
    pub allowed: bool,
}
```

**æŸ¥è¯¢å®¡è®¡æ—¥å¿—**:
```rust
pub fn query_minter_change_log(
    deps: Deps,
    start_after: Option<(Addr, u64)>,
    limit: Option<u32>,
) -> StdResult<Binary> {
    let limit = limit.unwrap_or(30).min(100) as usize;
    
    let logs: Vec<MinterChangeLog> = MINTER_CHANGE_LOG
        .range(deps.storage, start_after.map(|(addr, time)| Bound::exclusive((addr, time))), None, Order::Ascending)
        .take(limit)
        .collect::<Result<Vec<_>, _>>()?
        .into_iter()
        .map(|(_, log)| log)
        .collect();
    
    to_json_binary(&MinterChangeLogResponse { logs })
}
```

## è¿ç»´æµç¨‹

### 1. æ—¥å¸¸è¿ç»´

#### 1.1 ç›‘æ§æŒ‡æ ‡

**å…³é”®æŒ‡æ ‡**:
- åˆçº¦è°ƒç”¨é¢‘ç‡
- Gas æ¶ˆè€—è¶‹åŠ¿
- é”™è¯¯ç‡ç»Ÿè®¡
- é“¸é€ æ•°é‡ç›‘æ§
- åˆæˆæ“ä½œç»Ÿè®¡

**ç›‘æ§è„šæœ¬ç¤ºä¾‹**:
```bash
#!/bin/bash
# ç›‘æ§è„šæœ¬

CONTRACT_ADDRESS="luckee1..."
NODE="https://rpc.luckee-testnet.com:443"

# æŸ¥è¯¢åˆçº¦çŠ¶æ€
echo "=== åˆçº¦çŠ¶æ€ ==="
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

# æŸ¥è¯¢æ€»ä¾›åº”é‡
echo "=== æ€»ä¾›åº”é‡ ==="
TOTAL_SUPPLY=$(wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"contract_info": {}}' --node $NODE | jq -r '.data.total_supply')
echo "Total Supply: $TOTAL_SUPPLY"

# æŸ¥è¯¢æœ€è¿‘äº‹ä»¶
echo "=== æœ€è¿‘äº‹ä»¶ ==="
wasmd query txs --events "wasm._contract_address='$CONTRACT_ADDRESS'" --limit 10 --node $NODE
```

#### 1.2 å¥åº·æ£€æŸ¥

**å¥åº·æ£€æŸ¥è„šæœ¬**:
```bash
#!/bin/bash
# å¥åº·æ£€æŸ¥è„šæœ¬

CONTRACT_ADDRESS="luckee1..."
NODE="https://rpc.luckee-testnet.com:443"

# æ£€æŸ¥åˆçº¦æ˜¯å¦å¯è®¿é—®
echo "æ£€æŸ¥åˆçº¦å¯è®¿é—®æ€§..."
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE > /dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "âœ… åˆçº¦å¯è®¿é—®"
else
    echo "âŒ åˆçº¦ä¸å¯è®¿é—®"
    exit 1
fi

# æ£€æŸ¥åˆçº¦æ˜¯å¦æš‚åœ
echo "æ£€æŸ¥åˆçº¦çŠ¶æ€..."
PAUSED=$(wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"contract_info": {}}' --node $NODE | jq -r '.data.paused // false')
if [ "$PAUSED" = "false" ]; then
    echo "âœ… åˆçº¦æ­£å¸¸è¿è¡Œ"
else
    echo "âš ï¸ åˆçº¦å·²æš‚åœ"
fi

# æ£€æŸ¥é“¸é€ è€…æƒé™
echo "æ£€æŸ¥é“¸é€ è€…æƒé™..."
MINTERS=$(wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"all_minters": {}}' --node $NODE | jq -r '.data.minters')
echo "æˆæƒé“¸é€ è€…: $MINTERS"
```

### 2. åº”æ€¥å“åº”

#### 2.1 åº”æ€¥å“åº”æµç¨‹

**1. é—®é¢˜è¯†åˆ«**:
- ç›‘æ§å‘Šè­¦
- ç”¨æˆ·åé¦ˆ
- ç¤¾åŒºæŠ¥å‘Š

**2. é—®é¢˜è¯„ä¼°**:
- å½±å“èŒƒå›´è¯„ä¼°
- ä¸¥é‡ç¨‹åº¦è¯„ä¼°
- ç´§æ€¥ç¨‹åº¦è¯„ä¼°

**3. åº”æ€¥æªæ–½**:
- æš‚åœåˆçº¦ (å¦‚å¿…è¦)
- é€šçŸ¥ç›¸å…³æ–¹
- å¯åŠ¨è°ƒæŸ¥

**4. é—®é¢˜è§£å†³**:
- æ ¹å› åˆ†æ
- ä¿®å¤å®æ–½
- éªŒè¯æµ‹è¯•

**5. æ¢å¤æ“ä½œ**:
- æ¢å¤æœåŠ¡
- ç›‘æ§éªŒè¯
- äº‹åæ€»ç»“

#### 2.2 åº”æ€¥æ“ä½œè„šæœ¬

**ç´§æ€¥æš‚åœè„šæœ¬**:
```bash
#!/bin/bash
# ç´§æ€¥æš‚åœè„šæœ¬

CONTRACT_ADDRESS="luckee1..."
ADMIN_ADDRESS="luckee1..."
CHAIN_ID="luckee-testnet"
NODE="https://rpc.luckee-testnet.com:443"

echo "âš ï¸ æ‰§è¡Œç´§æ€¥æš‚åœæ“ä½œ..."
echo "åˆçº¦åœ°å€: $CONTRACT_ADDRESS"
echo "ç®¡ç†å‘˜: $ADMIN_ADDRESS"

# ç¡®è®¤æ“ä½œ
read -p "ç¡®è®¤æ‰§è¡Œæš‚åœæ“ä½œ? (yes/no): " confirm
if [ "$confirm" != "yes" ]; then
    echo "æ“ä½œå·²å–æ¶ˆ"
    exit 1
fi

# æ‰§è¡Œæš‚åœ
PAUSE_MSG='{"pause": {}}'
wasmd tx wasm execute $CONTRACT_ADDRESS "$PAUSE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes

echo "âœ… æš‚åœæ“ä½œå·²æ‰§è¡Œ"
```

**ç´§æ€¥æ¢å¤è„šæœ¬**:
```bash
#!/bin/bash
# ç´§æ€¥æ¢å¤è„šæœ¬

CONTRACT_ADDRESS="luckee1..."
ADMIN_ADDRESS="luckee1..."
CHAIN_ID="luckee-testnet"
NODE="https://rpc.luckee-testnet.com:443"

echo "ğŸ”„ æ‰§è¡Œæ¢å¤æ“ä½œ..."
echo "åˆçº¦åœ°å€: $CONTRACT_ADDRESS"
echo "ç®¡ç†å‘˜: $ADMIN_ADDRESS"

# ç¡®è®¤æ“ä½œ
read -p "ç¡®è®¤æ‰§è¡Œæ¢å¤æ“ä½œ? (yes/no): " confirm
if [ "$confirm" != "yes" ]; then
    echo "æ“ä½œå·²å–æ¶ˆ"
    exit 1
fi

# æ‰§è¡Œæ¢å¤
UNPAUSE_MSG='{"unpause": {}}'
wasmd tx wasm execute $CONTRACT_ADDRESS "$UNPAUSE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes

echo "âœ… æ¢å¤æ“ä½œå·²æ‰§è¡Œ"
```

### 3. å‡çº§ç®¡ç†

#### 3.1 å‡çº§æµç¨‹

**1. å‡çº§å‡†å¤‡**:
- ä»£ç å®¡æŸ¥
- æµ‹è¯•éªŒè¯
- å‡çº§è®¡åˆ’

**2. å‡çº§æ‰§è¡Œ**:
- ä¸Šä¼ æ–°ç‰ˆæœ¬
- æ‰§è¡Œè¿ç§»
- éªŒè¯åŠŸèƒ½

**3. å‡çº§åéªŒè¯**:
- åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½ç›‘æ§
- ç”¨æˆ·åé¦ˆ

#### 3.2 å‡çº§è„šæœ¬

**åˆçº¦å‡çº§è„šæœ¬**:
```bash
#!/bin/bash
# åˆçº¦å‡çº§è„šæœ¬

OLD_CONTRACT_ADDRESS="luckee1..."
NEW_WASM_FILE="target/wasm32-unknown-unknown/release/luckee_nft_v2_optimized.wasm"
ADMIN_ADDRESS="luckee1..."
CHAIN_ID="luckee-testnet"
NODE="https://rpc.luckee-testnet.com:443"

echo "ğŸ”„ å¼€å§‹åˆçº¦å‡çº§..."
echo "æ—§åˆçº¦åœ°å€: $OLD_CONTRACT_ADDRESS"
echo "æ–°WASMæ–‡ä»¶: $NEW_WASM_FILE"

# æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
if [ ! -f "$NEW_WASM_FILE" ]; then
    echo "âŒ WASMæ–‡ä»¶ä¸å­˜åœ¨: $NEW_WASM_FILE"
    exit 1
fi

# ä¸Šä¼ æ–°ç‰ˆæœ¬
echo "ğŸ“¤ ä¸Šä¼ æ–°ç‰ˆæœ¬åˆçº¦..."
UPLOAD_RESULT=$(wasmd tx wasm store "$NEW_WASM_FILE" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes \
  --output json)

NEW_CODE_ID=$(echo "$UPLOAD_RESULT" | jq -r '.logs[0].events[] | select(.type=="store_code") | .attributes[] | select(.key=="code_id") | .value')
echo "æ–°Code ID: $NEW_CODE_ID"

# æ‰§è¡Œè¿ç§»
echo "ğŸ”„ æ‰§è¡Œåˆçº¦è¿ç§»..."
MIGRATE_MSG='{"migrate": {}}'
wasmd tx wasm migrate $OLD_CONTRACT_ADDRESS $NEW_CODE_ID "$MIGRATE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes

echo "âœ… åˆçº¦å‡çº§å®Œæˆ"
echo "æ–°Code ID: $NEW_CODE_ID"
```

## å®¡è®¡è¦æ±‚

### 1. æ“ä½œå®¡è®¡

#### 1.1 é‡è¦æ“ä½œå®¡è®¡

**éœ€è¦å®¡è®¡çš„æ“ä½œ**:
- `set_recipe` - è®¾ç½®åˆæˆé…æ–¹
- `remove_recipe` - åˆ é™¤åˆæˆé…æ–¹
- `set_minter` - è®¾ç½®é“¸é€ è€…æƒé™
- `pause` - æš‚åœåˆçº¦
- `unpause` - æ¢å¤åˆçº¦
- `emergency_withdraw` - ç´§æ€¥æå–

**å®¡è®¡æ—¥å¿—ç»“æ„**:
```rust
#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub struct AuditLog {
    pub timestamp: u64,
    pub operator: Addr,
    pub action: String,
    pub details: String,
    pub tx_hash: Option<String>,
}
```

#### 1.2 å®¡è®¡æŸ¥è¯¢æ¥å£

**æŸ¥è¯¢å®¡è®¡æ—¥å¿—**:
```rust
pub fn query_audit_logs(
    deps: Deps,
    start_after: Option<(u64, String)>,
    limit: Option<u32>,
) -> StdResult<Binary> {
    let limit = limit.unwrap_or(30).min(100) as usize;
    
    let logs: Vec<AuditLog> = AUDIT_LOGS
        .range(deps.storage, start_after.map(|(time, action)| Bound::exclusive((time, action))), None, Order::Descending)
        .take(limit)
        .collect::<Result<Vec<_>, _>>()?
        .into_iter()
        .map(|(_, log)| log)
        .collect();
    
    to_json_binary(&AuditLogResponse { logs })
}
```

### 2. ç¦»çº¿å®¡æ ¸æµç¨‹

#### 2.1 å®¡æ ¸è¦æ±‚

**å®¡æ ¸å†…å®¹**:
- æ“ä½œåˆç†æ€§
- æƒé™éªŒè¯
- å‚æ•°æ­£ç¡®æ€§
- å½±å“è¯„ä¼°

**å®¡æ ¸æµç¨‹**:
1. æ“ä½œç”³è¯·
2. æŠ€æœ¯å®¡æ ¸
3. ä¸šåŠ¡å®¡æ ¸
4. å®‰å…¨å®¡æ ¸
5. æ‰§è¡Œæ‰¹å‡†

#### 2.2 å®¡æ ¸å·¥å…·

**å®¡æ ¸æ£€æŸ¥æ¸…å•**:
```markdown
# æ“ä½œå®¡æ ¸æ£€æŸ¥æ¸…å•

## åŸºæœ¬ä¿¡æ¯
- [ ] æ“ä½œç±»å‹: ___________
- [ ] æ“ä½œäººå‘˜: ___________
- [ ] æ“ä½œæ—¶é—´: ___________
- [ ] æ“ä½œåŸå› : ___________

## æŠ€æœ¯å®¡æ ¸
- [ ] å‚æ•°æ ¼å¼æ­£ç¡®
- [ ] æƒé™éªŒè¯é€šè¿‡
- [ ] ä¸šåŠ¡é€»è¾‘åˆç†
- [ ] å½±å“èŒƒå›´å¯æ§

## å®‰å…¨å®¡æ ¸
- [ ] æ— å®‰å…¨é£é™©
- [ ] ç¬¦åˆå®‰å…¨ç­–ç•¥
- [ ] å®¡è®¡æ—¥å¿—å®Œæ•´
- [ ] å›æ»šæ–¹æ¡ˆå¯è¡Œ

## ä¸šåŠ¡å®¡æ ¸
- [ ] ç¬¦åˆä¸šåŠ¡éœ€æ±‚
- [ ] ç”¨æˆ·ä½“éªŒè‰¯å¥½
- [ ] æˆæœ¬æ•ˆç›Šåˆç†
- [ ] é£é™©å¯æ§

## æ‰¹å‡†
- [ ] æŠ€æœ¯è´Ÿè´£äºº: ___________
- [ ] å®‰å…¨è´Ÿè´£äºº: ___________
- [ ] ä¸šåŠ¡è´Ÿè´£äºº: ___________
- [ ] æœ€ç»ˆæ‰¹å‡†: ___________
```

### 3. åˆè§„è¦æ±‚

#### 3.1 æ•°æ®ä¿æŠ¤

**éšç§ä¿æŠ¤**:
- ä¸å­˜å‚¨ç”¨æˆ·æ•æ„Ÿä¿¡æ¯
- æœ€å°åŒ–æ•°æ®æ”¶é›†
- æ•°æ®åŠ å¯†å­˜å‚¨
- è®¿é—®æƒé™æ§åˆ¶

**æ•°æ®ä¿ç•™**:
- å®¡è®¡æ—¥å¿—ä¿ç•™ 7 å¹´
- æ“ä½œè®°å½•æ°¸ä¹…ä¿ç•™
- å®šæœŸå¤‡ä»½æ•°æ®
- å®‰å…¨åˆ é™¤è¿‡æœŸæ•°æ®

#### 3.2 ç›‘ç®¡åˆè§„

**åˆè§„è¦æ±‚**:
- éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„
- æ»¡è¶³ç›‘ç®¡æœºæ„è¦æ±‚
- å®šæœŸåˆè§„æ£€æŸ¥
- åŠæ—¶æŠ¥å‘Šå¼‚å¸¸

**åˆè§„æ£€æŸ¥**:
```bash
#!/bin/bash
# åˆè§„æ£€æŸ¥è„šæœ¬

CONTRACT_ADDRESS="luckee1..."
NODE="https://rpc.luckee-testnet.com:443"

echo "=== åˆè§„æ£€æŸ¥æŠ¥å‘Š ==="
echo "æ£€æŸ¥æ—¶é—´: $(date)"
echo "åˆçº¦åœ°å€: $CONTRACT_ADDRESS"

# æ£€æŸ¥åˆçº¦çŠ¶æ€
echo "1. åˆçº¦çŠ¶æ€æ£€æŸ¥"
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

# æ£€æŸ¥æƒé™é…ç½®
echo "2. æƒé™é…ç½®æ£€æŸ¥"
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"contract_info": {}}' --node $NODE

# æ£€æŸ¥é“¸é€ è€…æƒé™
echo "3. é“¸é€ è€…æƒé™æ£€æŸ¥"
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"all_minters": {}}' --node $NODE

# æ£€æŸ¥åˆæˆé…æ–¹
echo "4. åˆæˆé…æ–¹æ£€æŸ¥"
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"all_recipes": {}}' --node $NODE

echo "=== æ£€æŸ¥å®Œæˆ ==="
```

## å®‰å…¨æœ€ä½³å®è·µ

### 1. å¯†é’¥ç®¡ç†

#### 1.1 å¯†é’¥å®‰å…¨

**å¯†é’¥ä¿æŠ¤**:
- ä½¿ç”¨ç¡¬ä»¶é’±åŒ…
- å¤šé‡ç­¾åéªŒè¯
- å®šæœŸå¯†é’¥è½®æ¢
- å®‰å…¨å¤‡ä»½å­˜å‚¨

**å¯†é’¥ç®¡ç†ç­–ç•¥**:
```bash
# å¯†é’¥ç®¡ç†è„šæœ¬
#!/bin/bash

# åˆ›å»ºæ–°å¯†é’¥
create_new_key() {
    local key_name=$1
    wasmd keys add $key_name --keyring-backend file
    echo "æ–°å¯†é’¥å·²åˆ›å»º: $key_name"
}

# å¤‡ä»½å¯†é’¥
backup_key() {
    local key_name=$1
    wasmd keys export $key_name --keyring-backend file --unarmored-hex > "${key_name}_backup.hex"
    echo "å¯†é’¥å·²å¤‡ä»½: ${key_name}_backup.hex"
}

# è½®æ¢å¯†é’¥
rotate_key() {
    local old_key=$1
    local new_key=$2
    
    echo "å¼€å§‹å¯†é’¥è½®æ¢..."
    create_new_key $new_key
    backup_key $old_key
    echo "å¯†é’¥è½®æ¢å®Œæˆ"
}
```

#### 1.2 å¤šç­¾é…ç½®

**å¤šç­¾é’±åŒ…è®¾ç½®**:
```bash
# åˆ›å»ºå¤šç­¾é’±åŒ…
wasmd keys add multisig-wallet --multisig-threshold 3 --multisig key1,key2,key3

# æŸ¥çœ‹å¤šç­¾ä¿¡æ¯
wasmd keys show multisig-wallet --multisig-threshold 3
```

### 2. ç›‘æ§å‘Šè­¦

#### 2.1 å‘Šè­¦é…ç½®

**å…³é”®å‘Šè­¦**:
- åˆçº¦æš‚åœ/æ¢å¤
- å¤§é‡é“¸é€ æ“ä½œ
- å¼‚å¸¸åˆæˆæ“ä½œ
- æƒé™å˜æ›´æ“ä½œ
- ç´§æ€¥æå–æ“ä½œ

**å‘Šè­¦è„šæœ¬**:
```bash
#!/bin/bash
# å‘Šè­¦è„šæœ¬

CONTRACT_ADDRESS="luckee1..."
NODE="https://rpc.luckee-testnet.com:443"
WEBHOOK_URL="https://hooks.slack.com/services/..."

# å‘é€å‘Šè­¦
send_alert() {
    local message=$1
    curl -X POST -H 'Content-type: application/json' \
        --data "{\"text\":\"ğŸš¨ Luckee NFT å‘Šè­¦: $message\"}" \
        $WEBHOOK_URL
}

# æ£€æŸ¥åˆçº¦çŠ¶æ€
check_contract_status() {
    local paused=$(wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"contract_info": {}}' --node $NODE | jq -r '.data.paused // false')
    if [ "$paused" = "true" ]; then
        send_alert "åˆçº¦å·²æš‚åœ"
    fi
}

# æ£€æŸ¥å¼‚å¸¸æ“ä½œ
check_anomalous_operations() {
    # æ£€æŸ¥æœ€è¿‘1å°æ—¶çš„é“¸é€ æ“ä½œ
    local mint_count=$(wasmd query txs --events "wasm._contract_address='$CONTRACT_ADDRESS'&wasm.action='mint'" --limit 100 --node $NODE | jq '.txs | length')
    if [ "$mint_count" -gt 50 ]; then
        send_alert "æ£€æµ‹åˆ°å¤§é‡é“¸é€ æ“ä½œ: $mint_count æ¬¡"
    fi
}

# æ‰§è¡Œæ£€æŸ¥
check_contract_status
check_anomalous_operations
```

### 3. åº”æ€¥å‡†å¤‡

#### 3.1 åº”æ€¥è®¡åˆ’

**åº”æ€¥å“åº”å›¢é˜Ÿ**:
- æŠ€æœ¯è´Ÿè´£äºº
- å®‰å…¨è´Ÿè´£äºº
- ä¸šåŠ¡è´Ÿè´£äºº
- å®¢æœè´Ÿè´£äºº

**åº”æ€¥è”ç³»æ–¹å¼**:
- æŠ€æœ¯å›¢é˜Ÿ: tech@luckee.io
- å®‰å…¨å›¢é˜Ÿ: security@luckee.io
- ä¸šåŠ¡å›¢é˜Ÿ: business@luckee.io

#### 3.2 åº”æ€¥å·¥å…·

**åº”æ€¥å·¥å…·åŒ…**:
```bash
#!/bin/bash
# åº”æ€¥å·¥å…·åŒ…

# ç¯å¢ƒé…ç½®
CONTRACT_ADDRESS="luckee1..."
ADMIN_ADDRESS="luckee1..."
CHAIN_ID="luckee-testnet"
NODE="https://rpc.luckee-testnet.com:443"

# å¿«é€Ÿæš‚åœ
quick_pause() {
    echo "æ‰§è¡Œå¿«é€Ÿæš‚åœ..."
    wasmd tx wasm execute $CONTRACT_ADDRESS '{"pause": {}}' \
      --from $ADMIN_ADDRESS \
      --chain-id $CHAIN_ID \
      --node $NODE \
      --gas auto \
      --yes
}

# å¿«é€Ÿæ¢å¤
quick_unpause() {
    echo "æ‰§è¡Œå¿«é€Ÿæ¢å¤..."
    wasmd tx wasm execute $CONTRACT_ADDRESS '{"unpause": {}}' \
      --from $ADMIN_ADDRESS \
      --chain-id $CHAIN_ID \
      --node $NODE \
      --gas auto \
      --yes
}

# çŠ¶æ€æ£€æŸ¥
status_check() {
    echo "åˆçº¦çŠ¶æ€æ£€æŸ¥..."
    wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE
}

# æ˜¾ç¤ºèœå•
show_menu() {
    echo "=== åº”æ€¥å·¥å…·åŒ… ==="
    echo "1. å¿«é€Ÿæš‚åœ"
    echo "2. å¿«é€Ÿæ¢å¤"
    echo "3. çŠ¶æ€æ£€æŸ¥"
    echo "4. é€€å‡º"
    echo "è¯·é€‰æ‹©æ“ä½œ: "
}

# ä¸»å¾ªç¯
while true; do
    show_menu
    read choice
    case $choice in
        1) quick_pause ;;
        2) quick_unpause ;;
        3) status_check ;;
        4) exit 0 ;;
        *) echo "æ— æ•ˆé€‰æ‹©" ;;
    esac
done
```

## æ€»ç»“

æœ¬å®‰å…¨ä¸è¿ç»´æŒ‡å—æä¾›äº† Luckee NFT åˆçº¦çš„å®Œæ•´å®‰å…¨ç®¡ç†æ¡†æ¶ï¼ŒåŒ…æ‹¬ï¼š

1. **æƒé™æ§åˆ¶**: æ˜ç¡®çš„è§’è‰²å®šä¹‰å’Œæƒé™éªŒè¯æœºåˆ¶
2. **è®¿é—®æ§åˆ¶**: åˆçº¦æš‚åœæœºåˆ¶å’Œç´§æ€¥æå–åŠŸèƒ½
3. **è¿ç»´æµç¨‹**: æ—¥å¸¸ç›‘æ§ã€åº”æ€¥å“åº”å’Œå‡çº§ç®¡ç†
4. **å®¡è®¡è¦æ±‚**: æ“ä½œå®¡è®¡ã€ç¦»çº¿å®¡æ ¸å’Œåˆè§„æ£€æŸ¥
5. **å®‰å…¨å®è·µ**: å¯†é’¥ç®¡ç†ã€ç›‘æ§å‘Šè­¦å’Œåº”æ€¥å‡†å¤‡

é€šè¿‡éµå¾ªæœ¬æŒ‡å—ï¼Œå¯ä»¥ç¡®ä¿ Luckee NFT åˆçº¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„å®‰å…¨ç¨³å®šè¿è¡Œï¼ŒåŒæ—¶æ»¡è¶³åˆè§„å’Œå®¡è®¡è¦æ±‚ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2024å¹´12æœˆ  
**ç»´æŠ¤å›¢é˜Ÿ**: Luckee DAO å®‰å…¨å›¢é˜Ÿ
