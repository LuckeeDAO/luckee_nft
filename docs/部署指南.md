# Luckee NFT åˆçº¦éƒ¨ç½²æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾› Luckee NFT åˆçº¦çš„å®Œæ•´éƒ¨ç½²æŒ‡å—ï¼ŒåŒ…æ‹¬çŽ¯å¢ƒé…ç½®ã€æž„å»ºæµç¨‹ã€éƒ¨ç½²æ­¥éª¤ã€å›žæ»šæ“ä½œå’Œè¿ç§»è¯´æ˜Žã€‚

## éƒ¨ç½²å‰å‡†å¤‡

### 1. ç³»ç»Ÿè¦æ±‚

**æœ€ä½Žç³»ç»Ÿè¦æ±‚**:
- Ubuntu 20.04+ / CentOS 8+ / macOS 10.15+
- 4GB RAM
- 10GB å¯ç”¨ç£ç›˜ç©ºé—´
- ç¨³å®šçš„ç½‘ç»œè¿žæŽ¥

**æŽ¨èç³»ç»Ÿé…ç½®**:
- Ubuntu 22.04 LTS
- 8GB RAM
- 20GB å¯ç”¨ç£ç›˜ç©ºé—´
- é«˜é€Ÿç½‘ç»œè¿žæŽ¥

### 2. å¿…éœ€è½¯ä»¶å®‰è£…

#### 2.1 Rust å·¥å…·é“¾

```bash
# å®‰è£… Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env

# æ·»åŠ  wasm32 ç›®æ ‡
rustup target add wasm32-unknown-unknown

# éªŒè¯å®‰è£…
rustc --version
cargo --version
```

#### 2.2 CosmWasm å·¥å…·é“¾

```bash
# å®‰è£… wasmd
wget https://github.com/CosmWasm/wasmd/releases/download/v0.45.0/wasmd-0.45.0-linux-amd64
chmod +x wasmd-0.45.0-linux-amd64
sudo mv wasmd-0.45.0-linux-amd64 /usr/local/bin/wasmd

# éªŒè¯å®‰è£…
wasmd version
```

#### 2.3 wasm-opt ä¼˜åŒ–å·¥å…·

```bash
# å®‰è£… wasm-opt (æŽ¨èä½¿ç”¨ Docker)
docker pull cosmwasm/workspace-optimizer

# æˆ–è€…ä»Žæºç ç¼–è¯‘
# éœ€è¦å®‰è£… binaryen
sudo apt-get update
sudo apt-get install binaryen
```

#### 2.4 å…¶ä»–ä¾èµ–

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install -y build-essential git jq curl

# CentOS/RHEL
sudo yum groupinstall -y "Development Tools"
sudo yum install -y git jq curl

# macOS
brew install git jq curl
```

## çŽ¯å¢ƒé…ç½®

### 1. å¿…éœ€çŽ¯å¢ƒå˜é‡

åˆ›å»ºçŽ¯å¢ƒé…ç½®æ–‡ä»¶ `.env`:

```bash
# ç®¡ç†å‘˜é…ç½®
export ADMIN_ADDRESS="luckee1admin..."              # ç®¡ç†å‘˜åœ°å€ (å¿…éœ€)
export ADMIN_KEY_NAME="admin"                       # ç®¡ç†å‘˜å¯†é’¥åç§°

# é“¸é€ è€…é…ç½®
export MINTER_ADDRESS="luckee1minter..."            # é“¸é€ è€…åœ°å€ (å¿…éœ€)

# é“¾é…ç½®
export CHAIN_ID="luckee-testnet"                    # é“¾ID (å¿…éœ€)
export NODE="https://rpc.luckee-testnet.com:443"    # RPCèŠ‚ç‚¹åœ°å€ (å¿…éœ€)
export GAS_PRICES="0.025uluckee"                    # Gasä»·æ ¼ (å¿…éœ€)
export GAS_ADJUSTMENT="1.5"                         # Gasè°ƒæ•´ç³»æ•°

# éƒ¨ç½²é…ç½®
export CONTRACT_NAME="luckee_nft"                   # åˆçº¦åç§°
export CONTRACT_VERSION="0.1.0"                     # åˆçº¦ç‰ˆæœ¬
export BASE_URI="https://luckee.io/metadata/"       # åŸºç¡€URI

# å¯†é’¥çŽ¯é…ç½®
export KEYRING_BACKEND="test"                       # å¯†é’¥çŽ¯åŽç«¯ (test/file/os)
export KEYRING_PASSWORD="your_password"             # å¯†é’¥çŽ¯å¯†ç 
```

### 2. å¯†é’¥ç®¡ç†

#### 2.1 åˆ›å»ºå¯†é’¥

```bash
# åˆ›å»ºç®¡ç†å‘˜å¯†é’¥
wasmd keys add $ADMIN_KEY_NAME --keyring-backend $KEYRING_BACKEND

# æŸ¥çœ‹å¯†é’¥åœ°å€
wasmd keys show $ADMIN_KEY_NAME --keyring-backend $KEYRING_BACKEND

# å¯¼å‡ºå¯†é’¥ (å¤‡ä»½ç”¨)
wasmd keys export $ADMIN_KEY_NAME --keyring-backend $KEYRING_BACKEND --unarmored-hex > admin_key.hex
```

#### 2.2 èŽ·å–æµ‹è¯•ä»£å¸

```bash
# ä»Žæµ‹è¯•ç½‘æ°´é¾™å¤´èŽ·å–ä»£å¸
curl -X POST "https://faucet.luckee-testnet.com/claim" \
  -H "Content-Type: application/json" \
  -d '{"address": "'$ADMIN_ADDRESS'"}'
```

### 3. éªŒè¯çŽ¯å¢ƒ

```bash
# éªŒè¯é“¾è¿žæŽ¥
wasmd query bank balances $ADMIN_ADDRESS --node $NODE

# éªŒè¯è´¦æˆ·ä½™é¢
wasmd query account $ADMIN_ADDRESS --node $NODE
```

## æž„å»ºæµç¨‹

### 1. æºç æž„å»º

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/luckee-dao/luckee_nft.git
cd luckee_nft

# æ£€æŸ¥ç¼–è¯‘
cargo check

# è¿è¡Œæµ‹è¯•
cargo test

# æž„å»º release ç‰ˆæœ¬
RUSTFLAGS='-C link-arg=-s' cargo build --release --target wasm32-unknown-unknown
```

### 2. no_std æž„å»º (æŽ¨è)

```bash
# æž„å»º no_std ç‰ˆæœ¬
cargo build --release --target wasm32-unknown-unknown --no-default-features --features cosmwasm

# éªŒè¯æž„å»ºç»“æžœ
ls -la target/wasm32-unknown-unknown/release/luckee_nft.wasm
```

### 3. WASM ä¼˜åŒ–

#### 3.1 ä½¿ç”¨ wasm-opt ä¼˜åŒ–

```bash
# æœ¬åœ°ä¼˜åŒ–
wasm-opt -Os target/wasm32-unknown-unknown/release/luckee_nft.wasm \
  -o target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm

# éªŒè¯ä¼˜åŒ–ç»“æžœ
ls -la target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm
```

#### 3.2 ä½¿ç”¨ Docker ä¼˜åŒ– (æŽ¨è)

```bash
# åˆ›å»ºä¼˜åŒ–è„šæœ¬
cat > optimize.sh << 'EOF'
#!/bin/bash
docker run --rm -v "$(pwd)":/code \
  --mount type=volume,source="$(basename "$(pwd)")_cache",target=/code/target \
  --mount type=volume,source=registry_cache,target=/usr/local/cargo/registry \
  cosmwasm/workspace-optimizer:0.14.0
EOF

chmod +x optimize.sh
./optimize.sh

# éªŒè¯ä¼˜åŒ–ç»“æžœ
ls -la artifacts/luckee_nft.wasm
```

### 4. æž„å»ºéªŒè¯

```bash
# æ£€æŸ¥ WASM æ–‡ä»¶å¤§å°
wc -c target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm

# éªŒè¯ WASM æ–‡ä»¶æ ¼å¼
file target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm

# è®¡ç®—æ–‡ä»¶å“ˆå¸Œ
sha256sum target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm
```

## éƒ¨ç½²æµç¨‹

### 1. ä½¿ç”¨éƒ¨ç½²è„šæœ¬ (æŽ¨è)

```bash
# ä½¿ç”¨é¡¹ç›®æä¾›çš„éƒ¨ç½²è„šæœ¬
./scripts/deploy.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS

# æˆ–è€…ä½¿ç”¨çŽ¯å¢ƒå˜é‡
ADMIN_ADDRESS=$ADMIN_ADDRESS MINTER_ADDRESS=$MINTER_ADDRESS ./scripts/deploy.sh
```

### 2. æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

#### 2.1 ä¸Šä¼ åˆçº¦

```bash
# ä¸Šä¼  WASM æ–‡ä»¶åˆ°é“¾ä¸Š
UPLOAD_RESULT=$(wasmd tx wasm store target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas-adjustment $GAS_ADJUSTMENT \
  --gas auto \
  --yes \
  --output json)

# æå– Code ID
CODE_ID=$(echo "$UPLOAD_RESULT" | jq -r '.logs[0].events[] | select(.type=="store_code") | .attributes[] | select(.key=="code_id") | .value')

echo "Code ID: $CODE_ID"
```

#### 2.2 å®žä¾‹åŒ–åˆçº¦

```bash
# åˆ›å»ºå®žä¾‹åŒ–æ¶ˆæ¯
INSTANTIATE_MSG=$(cat <<EOF
{
  "name": "$CONTRACT_NAME",
  "symbol": "LUCKEE",
  "minter": "$MINTER_ADDRESS",
  "base_uri": "$BASE_URI"
}
EOF
)

# å®žä¾‹åŒ–åˆçº¦
INSTANTIATE_RESULT=$(wasmd tx wasm instantiate $CODE_ID "$INSTANTIATE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas-adjustment $GAS_ADJUSTMENT \
  --gas auto \
  --label "luckee-nft-$CONTRACT_VERSION" \
  --admin $ADMIN_ADDRESS \
  --yes \
  --output json)

# æå–åˆçº¦åœ°å€
CONTRACT_ADDRESS=$(echo "$INSTANTIATE_RESULT" | jq -r '.logs[0].events[] | select(.type=="instantiate") | .attributes[] | select(.key=="_contract_address") | .value')

echo "Contract Address: $CONTRACT_ADDRESS"
```

#### 2.3 é…ç½®åˆçº¦

```bash
# è®¾ç½®é“¸é€ è€…æƒé™
SET_MINTER_MSG=$(cat <<EOF
{
  "set_minter": {
    "minter": "$MINTER_ADDRESS",
    "allowed": true
  }
}
EOF
)

wasmd tx wasm execute $CONTRACT_ADDRESS "$SET_MINTER_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas-adjustment $GAS_ADJUSTMENT \
  --gas auto \
  --yes \
  --output json
```

### 3. éƒ¨ç½²éªŒè¯

```bash
# æŸ¥è¯¢åˆçº¦ä¿¡æ¯
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

# æŸ¥è¯¢åˆçº¦é…ç½®
CONFIG_QUERY='{"contract_info": {}}'
wasmd query wasm contract-state smart $CONTRACT_ADDRESS "$CONFIG_QUERY" --node $NODE

# æŸ¥è¯¢åˆçº¦ä»£ç 
wasmd query wasm code $CODE_ID --node $NODE
```

### 4. éƒ¨ç½²åŽé…ç½®

#### 4.1 è®¾ç½®åˆæˆé…æ–¹

```bash
# è®¾ç½®åŸºç¡€åˆæˆé…æ–¹
SET_RECIPE_MSG=$(cat <<EOF
{
  "set_recipe": {
    "target": "Firefly",
    "recipe": {
      "inputs": [
        {
          "kind": "Clover",
          "amount": 2
        }
      ],
      "cost": {
        "denom": "uluckee",
        "amount": "1000"
      }
    }
  }
}
EOF
)

wasmd tx wasm execute $CONTRACT_ADDRESS "$SET_RECIPE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

#### 4.2 æµ‹è¯•é“¸é€ åŠŸèƒ½

```bash
# æµ‹è¯•é“¸é€  NFT
MINT_MSG=$(cat <<EOF
{
  "mint": {
    "token_id": 1,
    "owner": "$ADMIN_ADDRESS",
    "extension": {
      "kind": "Clover",
      "scale_origin": "Tiny",
      "physical_sku": null,
      "crafted_from": null,
      "series_id": "test_001",
      "collection_group_id": null,
      "serial_in_series": 1
    }
  }
}
EOF
)

wasmd tx wasm execute $CONTRACT_ADDRESS "$MINT_MSG" \
  --from $MINTER_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

## å›žæ»šæ“ä½œ

### 1. ç´§æ€¥æš‚åœ

```bash
# æš‚åœåˆçº¦
PAUSE_MSG='{"pause": {}}'

wasmd tx wasm execute $CONTRACT_ADDRESS "$PAUSE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

### 2. æ¢å¤åˆçº¦

```bash
# æ¢å¤åˆçº¦
UNPAUSE_MSG='{"unpause": {}}'

wasmd tx wasm execute $CONTRACT_ADDRESS "$UNPAUSE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

### 3. ç´§æ€¥æå–èµ„é‡‘

```bash
# ç´§æ€¥æå–èµ„é‡‘
EMERGENCY_MSG=$(cat <<EOF
{
  "emergency_withdraw": {
    "amount": [
      {
        "denom": "uluckee",
        "amount": "1000000"
      }
    ]
  }
}
EOF
)

wasmd tx wasm execute $CONTRACT_ADDRESS "$EMERGENCY_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

## è¿ç§»æ“ä½œ

### 1. è¿ç§»å‡†å¤‡

```bash
# æž„å»ºæ–°ç‰ˆæœ¬åˆçº¦
cargo build --release --target wasm32-unknown-unknown --no-default-features --features cosmwasm

# ä¼˜åŒ–æ–°ç‰ˆæœ¬
wasm-opt -Os target/wasm32-unknown-unknown/release/luckee_nft.wasm \
  -o target/wasm32-unknown-unknown/release/luckee_nft_v2_optimized.wasm
```

### 2. ä¸Šä¼ æ–°ç‰ˆæœ¬

```bash
# ä¸Šä¼ æ–°ç‰ˆæœ¬åˆçº¦
UPLOAD_RESULT=$(wasmd tx wasm store target/wasm32-unknown-unknown/release/luckee_nft_v2_optimized.wasm \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas-adjustment $GAS_ADJUSTMENT \
  --gas auto \
  --yes \
  --output json)

# æå–æ–° Code ID
NEW_CODE_ID=$(echo "$UPLOAD_RESULT" | jq -r '.logs[0].events[] | select(.type=="store_code") | .attributes[] | select(.key=="code_id") | .value')

echo "New Code ID: $NEW_CODE_ID"
```

### 3. æ‰§è¡Œè¿ç§»

```bash
# æ‰§è¡Œåˆçº¦è¿ç§»
MIGRATE_MSG='{"migrate": {}}'

wasmd tx wasm migrate $CONTRACT_ADDRESS $NEW_CODE_ID "$MIGRATE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --keyring-backend $KEYRING_BACKEND \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

### 4. è¿ç§»éªŒè¯

```bash
# éªŒè¯è¿ç§»ç»“æžœ
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

# æŸ¥è¯¢åˆçº¦ä»£ç 
wasmd query wasm code $NEW_CODE_ID --node $NODE

# æµ‹è¯•åˆçº¦åŠŸèƒ½
CONFIG_QUERY='{"contract_info": {}}'
wasmd query wasm contract-state smart $CONTRACT_ADDRESS "$CONFIG_QUERY" --node $NODE
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. å¯†é’¥å®‰å…¨

- **æ°¸è¿œä¸è¦**åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ç§é’¥
- ä½¿ç”¨å®‰å…¨çš„å¯†é’¥ç®¡ç†æ–¹æ¡ˆ
- å®šæœŸè½®æ¢å¯†é’¥
- å¤‡ä»½å¯†é’¥åˆ°å®‰å…¨ä½ç½®

### 2. éƒ¨ç½²å®‰å…¨

- åœ¨æµ‹è¯•ç½‘å……åˆ†æµ‹è¯•åŽå†éƒ¨ç½²åˆ°ä¸»ç½‘
- ä½¿ç”¨å¤šç­¾é’±åŒ…ä½œä¸ºç®¡ç†å‘˜åœ°å€
- è®¾ç½®åˆç†çš„ Gas é™åˆ¶
- ç›‘æŽ§éƒ¨ç½²è¿‡ç¨‹

### 3. è¿ç»´å®‰å…¨

- å®šæœŸå¤‡ä»½åˆçº¦çŠ¶æ€
- ç›‘æŽ§åˆçº¦äº‹ä»¶å’Œæ—¥å¿—
- è®¾ç½®å‘Šè­¦æœºåˆ¶
- å»ºç«‹åº”æ€¥å“åº”æµç¨‹

### 4. ä¸»ç½‘éƒ¨ç½²ç‰¹åˆ«æ³¨æ„äº‹é¡¹

- **å¿…é¡»**ä½¿ç”¨å¤šç­¾é’±åŒ…ä½œä¸ºç®¡ç†å‘˜
- **å¿…é¡»**åœ¨å†·é’±åŒ…ä¸­æ‰§è¡Œå…³é”®æ“ä½œ
- **ç¦æ­¢**åœ¨ CI/CD ä¸­ä¿å­˜ç§é’¥
- **å»ºè®®**ä½¿ç”¨ç¡¬ä»¶é’±åŒ…

## æ•…éšœæŽ’é™¤

### 1. å¸¸è§é—®é¢˜

#### 1.1 æž„å»ºå¤±è´¥

```bash
# æ¸…ç†æž„å»ºç¼“å­˜
cargo clean

# æ›´æ–°ä¾èµ–
cargo update

# é‡æ–°æž„å»º
cargo build --release --target wasm32-unknown-unknown
```

#### 1.2 ä¸Šä¼ å¤±è´¥

```bash
# æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
ping rpc.luckee-testnet.com

# æ£€æŸ¥è´¦æˆ·ä½™é¢
wasmd query bank balances $ADMIN_ADDRESS --node $NODE

# å¢žåŠ  Gas é™åˆ¶
--gas 2000000
```

#### 1.3 å®žä¾‹åŒ–å¤±è´¥

```bash
# æ£€æŸ¥å®žä¾‹åŒ–æ¶ˆæ¯æ ¼å¼
echo "$INSTANTIATE_MSG" | jq .

# éªŒè¯åœ°å€æ ¼å¼
wasmd keys show $ADMIN_ADDRESS --keyring-backend $KEYRING_BACKEND
```

### 2. æ—¥å¿—åˆ†æž

```bash
# æŸ¥çœ‹äº¤æ˜“æ—¥å¿—
wasmd query tx $TX_HASH --node $NODE

# æŸ¥çœ‹åˆçº¦äº‹ä»¶
wasmd query wasm contract-state all $CONTRACT_ADDRESS --node $NODE
```

### 3. æ€§èƒ½ä¼˜åŒ–

```bash
# ä½¿ç”¨æ›´å¿«çš„ RPC èŠ‚ç‚¹
export NODE="https://fast-rpc.luckee-testnet.com:443"

# è°ƒæ•´ Gas ä»·æ ¼
export GAS_PRICES="0.05uluckee"

# ä½¿ç”¨æ‰¹é‡æ“ä½œ
# åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ batch_mint è€Œä¸æ˜¯å¤šæ¬¡ mint
```

## å…¸åž‹ç¤ºä¾‹å‘½ä»¤ç‰‡æ®µ

### 1. æž„å»º no_std wasmï¼ˆrelease + ä¼˜åŒ–ï¼‰

```bash
# åŸºç¡€æž„å»º
cargo build --release --target wasm32-unknown-unknown --no-default-features --features cosmwasm

# ä¼˜åŒ–æž„å»ºï¼ˆæŽ¨èï¼‰
RUSTFLAGS='-C link-arg=-s' cargo build --release --target wasm32-unknown-unknown --no-default-features --features cosmwasm

# ä½¿ç”¨ wasm-opt ä¼˜åŒ–
wasm-opt -Os target/wasm32-unknown-unknown/release/luckee_nft.wasm -o target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm

# éªŒè¯æž„å»ºç»“æžœ
ls -lh target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm
sha256sum target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm
```

### 2. ç®€å•ä¸Šä¼  & instantiateï¼ˆç¤ºä¾‹ï¼‰

```bash
# è®¾ç½®çŽ¯å¢ƒå˜é‡
export ADMIN_ADDRESS="luckee1admin..."
export MINTER_ADDRESS="luckee1minter..."
export CHAIN_ID="luckee-testnet"
export NODE="https://rpc.luckee-testnet.com:443"
export GAS_PRICES="0.025uluckee"

# ä¸Šä¼ åˆçº¦
UPLOAD_RESULT=$(wasmd tx wasm store target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes \
  --output json)

# æå– Code ID
CODE_ID=$(echo "$UPLOAD_RESULT" | jq -r '.logs[0].events[] | select(.type=="store_code") | .attributes[] | select(.key=="code_id") | .value')
echo "Code ID: $CODE_ID"

# å®žä¾‹åŒ–åˆçº¦
INSTANTIATE_MSG='{"name":"Luckee NFT","symbol":"LUCKEE","minter":"'$MINTER_ADDRESS'","base_uri":"https://luckee.io/metadata/"}'

INSTANTIATE_RESULT=$(wasmd tx wasm instantiate $CODE_ID "$INSTANTIATE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --label "luckee-nft-v1" \
  --admin $ADMIN_ADDRESS \
  --yes \
  --output json)

# æå–åˆçº¦åœ°å€
CONTRACT_ADDRESS=$(echo "$INSTANTIATE_RESULT" | jq -r '.logs[0].events[] | select(.type=="instantiate") | .attributes[] | select(.key=="_contract_address") | .value')
echo "Contract Address: $CONTRACT_ADDRESS"
```

### 3. ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæŽ¨èï¼‰

```bash
# åŸºç¡€éƒ¨ç½²
./scripts/deploy.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS

# å¹²è¿è¡Œæ¨¡å¼ï¼ˆé¢„è§ˆï¼‰
./scripts/deploy.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS --dry-run

# è¯¦ç»†è¾“å‡ºæ¨¡å¼
./scripts/deploy.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS --verbose

# è·³è¿‡æž„å»ºæ­¥éª¤
./scripts/deploy.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS --skip-build

# ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²
./scripts/deploy_production.sh --admin $ADMIN_ADDRESS --minter $MINTER_ADDRESS
```

### 4. é…ç½®åˆçº¦æƒé™

```bash
# è®¾ç½®é“¸é€ è€…æƒé™
SET_MINTER_MSG='{"set_minter":{"minter":"'$MINTER_ADDRESS'","allowed":true}}'

wasmd tx wasm execute $CONTRACT_ADDRESS "$SET_MINTER_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

### 5. è®¾ç½®åˆæˆé…æ–¹

```bash
# è®¾ç½®åŸºç¡€åˆæˆé…æ–¹
SET_RECIPE_MSG='{
  "set_recipe": {
    "target": "Firefly",
    "recipe": {
      "inputs": [
        {
          "kind": "Clover",
          "amount": 2
        }
      ],
      "cost": {
        "denom": "uluckee",
        "amount": "1000"
      }
    }
  }
}'

wasmd tx wasm execute $CONTRACT_ADDRESS "$SET_RECIPE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes
```

### 6. æµ‹è¯•åˆçº¦åŠŸèƒ½

```bash
# æµ‹è¯•é“¸é€  NFT
MINT_MSG='{
  "mint": {
    "token_id": 1,
    "owner": "'$ADMIN_ADDRESS'",
    "extension": {
      "kind": "Clover",
      "scale_origin": "Tiny",
      "physical_sku": null,
      "crafted_from": null,
      "series_id": "test_001",
      "collection_group_id": null,
      "serial_in_series": 1
    }
  }
}'

wasmd tx wasm execute $CONTRACT_ADDRESS "$MINT_MSG" \
  --from $MINTER_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas-prices $GAS_PRICES \
  --gas auto \
  --yes

# æŸ¥è¯¢ NFT ä¿¡æ¯
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"owner_of":{"token_id":1}}' --node $NODE
```

### 7. éªŒè¯éƒ¨ç½²

```bash
# æŸ¥è¯¢åˆçº¦ä¿¡æ¯
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

# æŸ¥è¯¢åˆçº¦é…ç½®
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"contract_info":{}}' --node $NODE

# æŸ¥è¯¢æ‰€æœ‰åˆæˆé…æ–¹
wasmd query wasm contract-state smart $CONTRACT_ADDRESS '{"all_recipes":{}}' --node $NODE

# æŸ¥è¯¢åˆçº¦ä»£ç 
wasmd query wasm code $CODE_ID --node $NODE
```

### 8. ç›‘æŽ§å’Œè°ƒè¯•

```bash
# æŸ¥è¯¢æœ€è¿‘çš„åˆçº¦äº¤æ˜“
wasmd query txs --events "wasm._contract_address='$CONTRACT_ADDRESS'" --node $NODE --limit 10

# æŸ¥è¯¢ç‰¹å®šäº‹ä»¶
wasmd query txs --events "wasm._contract_address='$CONTRACT_ADDRESS'&wasm.action='mint'" --node $NODE --limit 10

# æŸ¥è¯¢è´¦æˆ·ä½™é¢
wasmd query bank balances $ADMIN_ADDRESS --node $NODE

# æŸ¥è¯¢è´¦æˆ·ä¿¡æ¯
wasmd query account $ADMIN_ADDRESS --node $NODE
```

### 9. é”™è¯¯æŽ’æŸ¥

```bash
# æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
ping $(echo $NODE | sed 's|https://||' | sed 's|:443||')

# æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€
wasmd status --node $NODE

# æ£€æŸ¥é“¾ID
wasmd status --node $NODE | jq -r '.node_info.network'

# æ£€æŸ¥åŒºå—é«˜åº¦
wasmd status --node $NODE | jq -r '.sync_info.latest_block_height'

# æ£€æŸ¥äº¤æ˜“çŠ¶æ€
wasmd query tx $TX_HASH --node $NODE
```

### 10. ä¸€é”®éƒ¨ç½²è„šæœ¬

```bash
#!/bin/bash
# ä¸€é”®éƒ¨ç½²è„šæœ¬ç¤ºä¾‹

set -e

# é…ç½®
ADMIN_ADDRESS="luckee1admin..."
MINTER_ADDRESS="luckee1minter..."
CHAIN_ID="luckee-testnet"
NODE="https://rpc.luckee-testnet.com:443"

echo "ðŸš€ å¼€å§‹ä¸€é”®éƒ¨ç½² Luckee NFT åˆçº¦..."

# 1. æž„å»ºåˆçº¦
echo "ðŸ“¦ æž„å»ºåˆçº¦..."
RUSTFLAGS='-C link-arg=-s' cargo build --release --target wasm32-unknown-unknown --no-default-features --features cosmwasm
wasm-opt -Os target/wasm32-unknown-unknown/release/luckee_nft.wasm -o target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm

# 2. ä¸Šä¼ åˆçº¦
echo "ðŸ“¤ ä¸Šä¼ åˆçº¦..."
UPLOAD_RESULT=$(wasmd tx wasm store target/wasm32-unknown-unknown/release/luckee_nft_optimized.wasm \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes \
  --output json)

CODE_ID=$(echo "$UPLOAD_RESULT" | jq -r '.logs[0].events[] | select(.type=="store_code") | .attributes[] | select(.key=="code_id") | .value')
echo "âœ… Code ID: $CODE_ID"

# 3. å®žä¾‹åŒ–åˆçº¦
echo "ðŸ—ï¸ å®žä¾‹åŒ–åˆçº¦..."
INSTANTIATE_MSG='{"name":"Luckee NFT","symbol":"LUCKEE","minter":"'$MINTER_ADDRESS'","base_uri":"https://luckee.io/metadata/"}'

INSTANTIATE_RESULT=$(wasmd tx wasm instantiate $CODE_ID "$INSTANTIATE_MSG" \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --label "luckee-nft-auto" \
  --admin $ADMIN_ADDRESS \
  --yes \
  --output json)

CONTRACT_ADDRESS=$(echo "$INSTANTIATE_RESULT" | jq -r '.logs[0].events[] | select(.type=="instantiate") | .attributes[] | select(.key=="_contract_address") | .value')
echo "âœ… Contract Address: $CONTRACT_ADDRESS"

# 4. é…ç½®æƒé™
echo "ðŸ” é…ç½®æƒé™..."
wasmd tx wasm execute $CONTRACT_ADDRESS '{"set_minter":{"minter":"'$MINTER_ADDRESS'","allowed":true}}' \
  --from $ADMIN_ADDRESS \
  --chain-id $CHAIN_ID \
  --node $NODE \
  --gas auto \
  --yes

# 5. éªŒè¯éƒ¨ç½²
echo "âœ… éªŒè¯éƒ¨ç½²..."
wasmd query wasm contract $CONTRACT_ADDRESS --node $NODE

echo "ðŸŽ‰ éƒ¨ç½²å®Œæˆï¼"
echo "Code ID: $CODE_ID"
echo "Contract Address: $CONTRACT_ADDRESS"
```

## éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥

- [ ] çŽ¯å¢ƒå˜é‡å·²æ­£ç¡®è®¾ç½®
- [ ] è´¦æˆ·ä½™é¢å……è¶³
- [ ] ç½‘ç»œè¿žæŽ¥æ­£å¸¸
- [ ] ä¾èµ–è½¯ä»¶å·²å®‰è£…
- [ ] å¯†é’¥å·²å¤‡ä»½

### æž„å»ºæ£€æŸ¥

- [ ] ä»£ç ç¼–è¯‘é€šè¿‡
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] WASM æ–‡ä»¶å·²ä¼˜åŒ–
- [ ] æ–‡ä»¶å¤§å°åˆç†
- [ ] å“ˆå¸Œå€¼å·²è®°å½•

### éƒ¨ç½²æ£€æŸ¥

- [ ] åˆçº¦ä¸Šä¼ æˆåŠŸ
- [ ] Code ID å·²è®°å½•
- [ ] åˆçº¦å®žä¾‹åŒ–æˆåŠŸ
- [ ] åˆçº¦åœ°å€å·²è®°å½•
- [ ] æƒé™é…ç½®æ­£ç¡®

### éƒ¨ç½²åŽæ£€æŸ¥

- [ ] åˆçº¦åŠŸèƒ½æ­£å¸¸
- [ ] äº‹ä»¶è®°å½•æ­£ç¡®
- [ ] æŸ¥è¯¢å“åº”æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£ç¡®
- [ ] æ€§èƒ½è¡¨çŽ°è‰¯å¥½

## è”ç³»æ”¯æŒ

å¦‚æžœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæŽ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥é¡¹ç›®çš„ GitHub Issues
3. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ
4. æä¾›è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’ŒçŽ¯å¢ƒä¿¡æ¯

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åŽæ›´æ–°**: 2024å¹´12æœˆ  
**ç»´æŠ¤å›¢é˜Ÿ**: Luckee DAO
